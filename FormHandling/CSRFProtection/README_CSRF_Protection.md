
# 🛡️ CSRF Protection in Flask

Cross-Site Request Forgery (**CSRF**) is a serious security vulnerability where an attacker tricks an authenticated user into submitting unwanted requests to a web application.

---

## ⚠️ The Threat

If not protected, attackers can perform actions like changing passwords or making purchases on behalf of the user — all without the user's knowledge.

---

## 📷 How CSRF Attacks Work

![CSRF Diagram](csrf_protection_diagram.png)

- A **Genuine User** submits a form containing a **CSRF token**, which the server verifies.
- A **Malicious User** tries to submit the same form **without a valid token**, and the server **rejects the request**.

---

## 🔐 Preventing CSRF Attacks

The most effective method is using **CSRF Tokens** — unique, unpredictable strings attached to every form. These tokens are generated by the server and validated when the form is submitted.

---

## ⚙️ Implementation in Flask

### Step 1: Install Required Packages

```bash
pip install flask flask-wtf
```

### Step 2: Set Up the Flask App (`main.py`)

Enable CSRF protection using `Flask-WTF`. When you inherit from `FlaskForm`, CSRF tokens are automatically embedded.

```python
from flask import Flask, render_template
from flask_wtf import FlaskForm
from wtforms import StringField, SubmitField

app = Flask(__name__)
app.config['SECRET_KEY'] = 'your-secret-key'

class SecureForm(FlaskForm):
    name = StringField('Name')
    submit = SubmitField('Submit')
```

### Step 3: Create a Secure HTML Form (`index.html`)

```html
<form method="POST">
    {{ form.csrf_token }}
    {{ form.name.label }} {{ form.name }}
    {{ form.submit }}
</form>
```

Also try an **unprotected form** on the same page without `{{ form.csrf_token }}` to observe the difference.

---

## ▶️ Running the Flask App

Run the server with:
```bash
python app.py
```

Open your browser and navigate to:
```
http://127.0.0.1:5000/protected_form
```

---

## 🧪 Testing the Protection

- **Unprotected Form**: Will submit with no CSRF token. This is vulnerable.
- **Protected Form**: Requires a valid CSRF token. Without it, the server will reject the request.

You'll see an error if you remove or alter the token — demonstrating CSRF defense in action.

---

## ✅ Summary

| Feature           | Unprotected Form | Protected Form |
|-------------------|------------------|----------------|
| CSRF Token        | ❌ No            | ✅ Yes         |
| Vulnerable to CSRF| ✅ Yes           | ❌ No          |
| Secure Submission | ❌ No            | ✅ Yes         |

Using Flask-WTF and CSRF tokens adds an important security layer to your forms. Every user action becomes verifiable and protected. 🔐
